---
layout: pages
title: python机器学习与数据挖掘培训
date: 2022-08-05 09:14:04
tags:
  - 培训
  - 机器学习
categories:
  - 培训
  - python
  - 机器学习
---

2022 年数据挖掘培训记录。

<!--more-->

DARPA AI：四个阶段五大领域

- 语音识别（语音交互等）
- 环境感知（图像识别等）
- AI 技术（深度学习等）
- 机器人自主控制
- 群组协同

AI 技术的目标是复制或超越计算机系统中需要人类智能的部分。

# 机器学习的学习方式

- 有监督学习
  - 每个训练样本包括输入特征 x 和输出 y（标记）
  - 总结规律，预测答案
  - 具体技术：决策树，支持向量机，朴素贝叶斯，回归预测
- 无监督学习
  - 训练样本只有 x 没有 y
  - 可以总结特征的一些规律，但是无法知道答案 y
  - 具体技术：聚类（k-means），关联规则（apriori）
- 半监督学习
  - 先用无监督学习先做一些聚类，让模型总结相似
  - 再用少量的带标注的训练样本，告诉模型对应的答案
  - 模型最后把相似的样本对应到标记
- 强化学习
  - 主要特点：试错学习，延迟反馈，时间是重要因素，当前的行为影响后续接收到的数据
  - 基本组成：Agent（智能体），Environment（环境），State（状态），Action（行动），Reward（奖励），Value（价值）

# 机器学习模型

- 聚类/分类/回归（基于 sklearn）
- 决策树
- 智能推荐算法
- 关联规则

# 数据预处理

1. 使用 sklearn 转换器处理数据
2. 构建并评价聚类模型
3. 构建并评价分类模型
4. 构建并评价回归模型

## 将数据集划分为训练集和测试集

典型划分方式是训练集 50%，验证集和测试集各占 25%。

- 当数据总量较少时，常用方法是留少部分做测试集，然后对其余样本采用 K 折交叉验证法。
- tran_test_split 函数

## 使用 sklearn 转换器进行数据预处理与降维

使用 sklearn 转换器能够实现对传入的 numpy 数组进行标准化处理、归一化处理、二值化处理、PCA 降维等操作，主要包括 3 个方法。

- fit
- transform
- fit_transform

在数据分析过程中，各类特征处理相关的操作都需要对训练集和测试集分开操作，需要将训练集的操作规则权重系数等应用到测试集中。

- MinMaxScaler
- StandardScaler
- Normalizer
- Binarizer
- OneHotEncoder
- FunctionTransformer

PCA 降维算法函数。

- n_componnets
- copy
- whiten
- svd_solver

## 使用 sklearn 估计器构建聚类模型

算法类别：

- 划分（分裂）方法：K-Means 算法（K-平均）、K-MEDOIDS 算法（K-中心点）、CLARANS 算法（基于选择的算法）
- 层次分析算法：BIRCH 算法（平衡迭代规约和聚类）、CURE 算法（代表点聚类）、CHAMEleon 算法（动态模型）
- 基于密度的方法：DBSCAN 算法（基于高密度连接区域）、DENCLUE 算法（密度分布函数）、OPTICS 算法（对象排序识别）
- 基于网格的算法：STING 算法（统计信息网络）、CLIOUE 算法（聚类高维空间）、WAVE-CLUSTER 算法（小波变换）

常用的聚类算法模块 cluster。

# 决策树

决策树是机器学习中一种基本的分类和回归算法，是依托于策略抉择而建立起来的树。

## 随机森林

随机森林是通过机器学习的思想将多棵树集成的一种算法，它的基本单元是决策树，本质属于集成学习（Ensemble Learning）方法。

# Xgboost 算法

根据各个弱分类器之间有无依赖关系，分为：

- Boosting 流派，各分类器之间有依赖关系，必须串行，如 Adaboost、GBDT（Gradient Boosting Decision Tree）、Xgboost
- Bagging 流派，各分类器之间没有依赖关系，可各自并行，如随机森林（Random Forest）

# 智能推荐算法

具体主流模型

1. 协同过滤算法（Collaborate Filtering）
   1. 基于对用户历史行为数据的挖掘发现用户的喜好偏向，并预测用户可能喜好的 item（产品，服务）进行推荐
   2. 主要实现：
      - 根据有共同喜好的人进行推荐
      - 根据喜好的 item 推荐相似 item
      - 根据以上条件综合推荐
   3. 常用算法分为两种：
      - 基于用户的协同过滤算法（userCF）
      - 基于物品的协同过滤算法（itemCF）
2. 隐语义模型（Latent Factor Model）
   1. 对所有的 item（产品，文档）进行分类，再根据用户的兴趣分类给用户推荐该分类中的 item
   2. 模型的主要工作：
      - 给 item 分类
      - 确定用户兴趣（特征）属于哪些类及感兴趣程度
      - 对于用户感兴趣的类，具体推荐哪些 item 给用户
3. 图
   1. 以 Personal Rank 为例，将用户行为数据用二分图表示，例如用户数据是由一系列的二元组组成，其中每个元组（u，i）表示用户 u 对物品 i 产生过行为

# 关联规则

是反映一个事物与其他事物之间的相互依存性和关联性。

常用于实体电商或在线电商的推荐系统：通过对顾客的购买记录数据库进行关联规则挖掘，最终目的是发现顾客群体的购买习惯的内在共性。

关键概念：

1. 支持度（Support）

- 两件商品（X∩Y）在总销售笔数（N）中出现的概率

2. 置信度（Confidence）

- 购买 X 后再购买 Y 的条件概率

3. 提升度（Lift）

- 表示先购买 X 对购买 Y 的概率的提升作用，用来判断规则是否有实际价值

# 机器学习应用

## 金融反欺诈：检测，响应，预防

应用实践：

1. 利用设备指纹技术对设备和身份进行初步识别
2. 基于非监督式的异常检测，将数据分解为正常趋势、随机扰动和异常情况三个部分
3. 在第 2 基础上实现画像，对设备、网络和用户三个层面的“千人千面”
4. 基于生成式概率模型的特征学习，形成了统一的多层特征模型
5. 将各个维度的特征统一成一种单位，归一化处理便于模型和人工对欺诈风险进行综合评估，规避传统静态规则的灵活性差的问题
6. 基于图模型学习的欺诈网络识别，利用高效的图聚类和社交网络算法，对欺诈网络进行动态地实时识别

实例：账户盗用检测、支付欺诈监测、内容滥用监测、营销推广滥用监测。

## 文本分类分析

把文档转为向量，按复杂性排序：

1. 加载文档，切词，NLP
2. 将切词结果转为词汇库（编号，出现频次）
3. 对切词结果进行清洗，转为精简词汇库（出现与否）

# 示例代码库

https://github.com/Ashestar/python_data_mining
